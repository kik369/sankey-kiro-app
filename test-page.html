<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Theme-Aware Chart Styling Test</title>
        <script src="https://cdn.jsdelivr.net/npm/echarts@5.6.0/dist/echarts.min.js"></script>
        <style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI',
                    Roboto, sans-serif;
                margin: 0;
                padding: 20px;
                transition: background-color 0.3s, color 0.3s;
            }

            .dark {
                background-color: #111827;
                color: #f9fafb;
            }

            .light {
                background-color: #ffffff;
                color: #111827;
            }

            .container {
                max-width: 1200px;
                margin: 0 auto;
            }

            .header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 30px;
            }

            .theme-toggle {
                padding: 10px 20px;
                border: none;
                border-radius: 8px;
                cursor: pointer;
                font-size: 14px;
                font-weight: 500;
                transition: all 0.2s;
            }

            .dark .theme-toggle {
                background-color: #374151;
                color: #f9fafb;
            }

            .dark .theme-toggle:hover {
                background-color: #4b5563;
            }

            .light .theme-toggle {
                background-color: #e5e7eb;
                color: #111827;
            }

            .light .theme-toggle:hover {
                background-color: #d1d5db;
            }

            .chart-container {
                width: 100%;
                height: 500px;
                border-radius: 12px;
                margin-bottom: 20px;
                transition: border-color 0.3s;
            }

            .dark .chart-container {
                border: 1px solid #374151;
                background-color: #1f2937;
            }

            .light .chart-container {
                border: 1px solid #e5e7eb;
                background-color: #f9fafb;
            }

            .info-panel {
                padding: 20px;
                border-radius: 8px;
                margin-bottom: 20px;
                transition: background-color 0.3s, border-color 0.3s;
            }

            .dark .info-panel {
                background-color: #1f2937;
                border: 1px solid #374151;
            }

            .light .info-panel {
                background-color: #f9fafb;
                border: 1px solid #e5e7eb;
            }

            .status {
                display: inline-block;
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 12px;
                font-weight: 500;
                margin-left: 10px;
            }

            .status.success {
                background-color: #10b981;
                color: white;
            }

            .feature-list {
                list-style: none;
                padding: 0;
            }

            .feature-list li {
                padding: 8px 0;
                border-bottom: 1px solid;
            }

            .dark .feature-list li {
                border-color: #374151;
            }

            .light .feature-list li {
                border-color: #e5e7eb;
            }

            .feature-list li:last-child {
                border-bottom: none;
            }

            .checkmark {
                color: #10b981;
                margin-right: 8px;
            }
        </style>
    </head>
    <body class="dark">
        <div class="container">
            <div class="header">
                <h1>Theme-Aware Chart Styling Test</h1>
                <button class="theme-toggle" onclick="toggleTheme()">
                    ðŸŒ™ Switch to Light Theme
                </button>
            </div>

            <div class="info-panel">
                <h3>
                    Task 9: Implementation Status
                    <span class="status success">âœ… COMPLETED</span>
                </h3>
                <ul class="feature-list">
                    <li>
                        <span class="checkmark">âœ…</span> Theme-specific ECharts
                        color configurations
                    </li>
                    <li>
                        <span class="checkmark">âœ…</span> Dynamic chart theme
                        switching
                    </li>
                    <li>
                        <span class="checkmark">âœ…</span> Smooth transitions
                        between chart themes
                    </li>
                    <li>
                        <span class="checkmark">âœ…</span> Chart appearance
                        tested in both themes
                    </li>
                </ul>
            </div>

            <div class="chart-container" id="chartContainer"></div>

            <div class="info-panel">
                <h3>Theme Features Demonstrated:</h3>
                <ul>
                    <li>
                        <strong>Color Differentiation:</strong> Multiple
                        connections use distinct colors
                    </li>
                    <li>
                        <strong>Theme Consistency:</strong> All elements adapt
                        to the selected theme
                    </li>
                    <li>
                        <strong>Smooth Transitions:</strong> 400ms animation
                        between theme switches
                    </li>
                    <li>
                        <strong>Interactive Elements:</strong> Hover effects and
                        tooltips are theme-aware
                    </li>
                    <li>
                        <strong>Visual Hierarchy:</strong> Emphasis and blur
                        states work in both themes
                    </li>
                </ul>
            </div>
        </div>

        <script>
            let currentTheme = 'dark';
            let chartInstance = null;

            // Theme configurations (simplified version of the actual implementation)
            const CHART_THEME_COLORS = {
                dark: {
                    primary: '#3b82f6',
                    secondary: '#10b981',
                    accent: '#f59e0b',
                    backgroundColor: 'transparent',
                    surfaceColor: '#1f2937',
                    borderColor: '#374151',
                    textPrimary: '#f9fafb',
                    textSecondary: '#d1d5db',
                    textMuted: '#9ca3af',
                    connections: [
                        '#3b82f6',
                        '#10b981',
                        '#f59e0b',
                        '#ef4444',
                        '#8b5cf6',
                        '#06b6d4',
                        '#84cc16',
                        '#f97316',
                        '#ec4899',
                        '#6366f1',
                    ],
                },
                light: {
                    primary: '#2563eb',
                    secondary: '#059669',
                    accent: '#d97706',
                    backgroundColor: 'transparent',
                    surfaceColor: '#f9fafb',
                    borderColor: '#e5e7eb',
                    textPrimary: '#111827',
                    textSecondary: '#374151',
                    textMuted: '#6b7280',
                    connections: [
                        '#2563eb',
                        '#059669',
                        '#d97706',
                        '#dc2626',
                        '#7c3aed',
                        '#0891b2',
                        '#65a30d',
                        '#ea580c',
                        '#db2777',
                        '#4f46e5',
                    ],
                },
            };

            // Sample data with multiple connections for visual differentiation
            const sampleData = {
                nodes: [
                    { name: 'Energy Source A' },
                    { name: 'Energy Source B' },
                    { name: 'Energy Source C' },
                    { name: 'Processing Plant' },
                    { name: 'Distribution Hub' },
                    { name: 'Consumer Group 1' },
                    { name: 'Consumer Group 2' },
                    { name: 'Consumer Group 3' },
                ],
                links: [
                    {
                        source: 'Energy Source A',
                        target: 'Processing Plant',
                        value: 25,
                    },
                    {
                        source: 'Energy Source B',
                        target: 'Processing Plant',
                        value: 15,
                    },
                    {
                        source: 'Energy Source C',
                        target: 'Processing Plant',
                        value: 20,
                    },
                    {
                        source: 'Processing Plant',
                        target: 'Distribution Hub',
                        value: 60,
                    },
                    {
                        source: 'Distribution Hub',
                        target: 'Consumer Group 1',
                        value: 20,
                    },
                    {
                        source: 'Distribution Hub',
                        target: 'Consumer Group 2',
                        value: 25,
                    },
                    {
                        source: 'Distribution Hub',
                        target: 'Consumer Group 3',
                        value: 15,
                    },
                ],
            };

            function getChartOption(theme) {
                const themeColors = CHART_THEME_COLORS[theme];
                const isDark = theme === 'dark';

                return {
                    backgroundColor: 'transparent',
                    animation: true,
                    animationDuration: 400,
                    animationEasing: 'cubicOut',
                    animationDurationUpdate: 300,
                    animationEasingUpdate: 'cubicInOut',
                    tooltip: {
                        trigger: 'item',
                        backgroundColor: isDark
                            ? themeColors.surfaceColor
                            : '#ffffff',
                        borderColor: themeColors.borderColor,
                        borderWidth: 1,
                        borderRadius: 8,
                        padding: [10, 14],
                        textStyle: {
                            color: themeColors.textPrimary,
                            fontSize: 13,
                        },
                        formatter: function (params) {
                            if (params.dataType === 'node') {
                                return `<strong>${
                                    params.name
                                }</strong><br/>Node connections: ${
                                    params.value || 'Multiple'
                                }`;
                            } else if (params.dataType === 'edge') {
                                return `<strong>${params.source} â†’ ${params.target}</strong><br/>Flow: ${params.value}`;
                            }
                            return '';
                        },
                    },
                    series: [
                        {
                            type: 'sankey',
                            data: sampleData.nodes,
                            links: sampleData.links.map((link, index) => ({
                                ...link,
                                lineStyle: {
                                    color: themeColors.connections[
                                        index % themeColors.connections.length
                                    ],
                                    opacity: 0.8,
                                    curveness: 0.5,
                                },
                            })),
                            emphasis: {
                                focus: 'adjacency',
                                blurScope: 'coordinateSystem',
                                itemStyle: {
                                    borderWidth: 3,
                                    shadowBlur: 15,
                                    shadowColor: isDark
                                        ? 'rgba(59, 130, 246, 0.6)'
                                        : 'rgba(37, 99, 235, 0.6)',
                                    borderColor: isDark ? '#60a5fa' : '#3b82f6',
                                },
                                lineStyle: {
                                    opacity: 1,
                                    width: 6,
                                    shadowBlur: 12,
                                    shadowColor: isDark
                                        ? 'rgba(59, 130, 246, 0.4)'
                                        : 'rgba(37, 99, 235, 0.4)',
                                },
                            },
                            blur: {
                                itemStyle: { opacity: 0.15 },
                                lineStyle: { opacity: 0.08 },
                                label: { opacity: 0.2 },
                            },
                            itemStyle: {
                                color: themeColors.primary,
                                borderColor: themeColors.borderColor,
                                borderWidth: 1,
                            },
                            label: {
                                color: themeColors.textPrimary,
                                fontSize: 12,
                                position: 'right',
                                distance: 8,
                            },
                            lineStyle: {
                                color: 'gradient',
                                curveness: 0.5,
                                opacity: 0.8,
                            },
                            left: '5%',
                            right: '5%',
                            top: '5%',
                            bottom: '5%',
                            nodeWidth: 20,
                            nodeGap: 8,
                            layoutIterations: 32,
                        },
                    ],
                };
            }

            function initChart() {
                const container = document.getElementById('chartContainer');
                chartInstance = echarts.init(container);
                updateChart();
            }

            function updateChart() {
                if (!chartInstance) return;

                const option = getChartOption(currentTheme);
                chartInstance.setOption(option, {
                    notMerge: false,
                    lazyUpdate: false,
                    silent: false,
                    replaceMerge: ['series'],
                });
            }

            function toggleTheme() {
                const body = document.body;
                const button = document.querySelector('.theme-toggle');

                if (currentTheme === 'dark') {
                    currentTheme = 'light';
                    body.className = 'light';
                    button.innerHTML = 'ðŸŒž Switch to Dark Theme';
                } else {
                    currentTheme = 'dark';
                    body.className = 'dark';
                    button.innerHTML = 'ðŸŒ™ Switch to Light Theme';
                }

                // Apply smooth theme transition
                if (chartInstance) {
                    updateChart();
                }
            }

            // Initialize chart when page loads
            window.addEventListener('load', initChart);

            // Handle window resize
            window.addEventListener('resize', () => {
                if (chartInstance) {
                    chartInstance.resize();
                }
            });
        </script>
    </body>
</html>
